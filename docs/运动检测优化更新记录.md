# 运动检测优化更新记录

## 修改概览
- 依照“方案一”优化智能状态机，补齐冷却控制与稳定性约束，消除重复事件与光照误判
- 同步更新基础运动检测器，支持光照跳帧、冷却节流与背景建模模式切换

## 修改明细
- utils/smart_motion_detector.py:66 引入 detection_cooldown，重建冷却与背景波动过滤参数
- utils/smart_motion_detector.py:106 重写 detect_motion_smart 流程，增加光照跳帧与背景大幅变化过滤
- utils/smart_motion_detector.py:208 更新状态机，结合面积/中心位移/冷却期判断，避免稳定状态重复触发
- utils/smart_motion_detector.py:305 _preprocess_frame 改为返回二元组，光照突变直接跳帧不污染背景模型
- utils/smart_motion_detector.py:387 get_motion_mask 同步跳帧逻辑，保障调试视图与检测一致
- utils/motion_detector.py:29 增加冷却配置与背景模型选择，构建统一建模入口
- utils/motion_detector.py:64 主检测流程支持光照跳帧与冷却节流，输出稳定的布尔结果
- utils/motion_detector.py:96 _preprocess_frame 与智能检测保持一致，提升误判防护能力
- utils/motion_detector.py:175 扩展配置热更新，动态切换 KNN/MOG2、阈值与冷却参数
- `worker/motion_detection_worker.py:30` 新增 `motion_state_changed` 信号并按配置装配智能/基础检测器，统一使用工具层逻辑
- `worker/motion_detection_worker.py:101` 重构检测主循环，结合稳定事件、捕获冷却与 API 客户端，保持与 SmartMotionDetector 状态输出同步

## 额外说明
- 所有新增日志与注释均使用中文，便于现场调试与维护
- 若需回滚旧逻辑，可对比 Git 历史版本中的同名文件
